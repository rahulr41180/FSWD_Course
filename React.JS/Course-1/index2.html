
<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <strong>Credit:<br>
        JavaScript: How to capture image from video?<br>
        By: Manu Bhardwaj
        <br><br></strong>
    <a
        href="https://medium.com/@immanubhardwaj/javascript-how-to-capture-image-from-video-ac7dba01a8e7">https://medium.com/@immanubhardwaj/javascript-how-to-capture-image-from-video-ac7dba01a8e7</a><br>
    <video id="video" src="https://www.tutorialspoint.com/videos/sample720.mp4" type="video/mp4" controls></video>
    <br>
    <button onclick="capture()">Capture</button>
    <br>

    <canvas style="width: 1024px; height: 768px;" id="canvas" style="overflow:auto"></canvas>

    <a id="downloadLink" style="display: none;" download="screenshot.png">Download Screenshot</a>
</body>

</html>

<script>
    function capture() {
        var canvas = document.getElementById("canvas");
        var video = document.querySelector("video");
        var downloadLink = document.getElementById('downloadLink');

        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        canvas
        .getContext("2d")
        .drawImage(video, 0, 0, video.videoWidth, video.videoHeight);
        
        /** Code to merge image **/
        /** For instance, if I want to merge a play image on center of existing image **/
        // const playImage = new Image();
        // playImage.src = "path to image asset";
        // playImage.onload = () => {
        //     const startX = video.videoWidth / 2 - playImage.width / 2;
        //     const startY = video.videoHeight / 2 - playImage.height / 2;
        //     canvas
        //     .getContext("2d")
        //     .drawImage(playImage, startX, startY, playImage.width, playImage.height);
        //     canvas.toBlob() = (blob) => {
        //         const img = new Image();
        //         img.src = window.URL.createObjectUrl(blob);
        //     };
        // };
        /** End **/
        // var screenshotDataUrl = canvas.toDataURL('image/png');
        // downloadLink.href = screenshotDataUrl;
        // downloadLink.style.display = 'block';
        console.log('canvas:', canvas.value)

        return;
    }
    
    // Get a reference to the video element
    var video = document.getElementById('video');
    
    // Set the specific time in seconds when you want to stop the video

    var stopTime = 2; // Stop the video at 10 seconds
    
    // Listen for the 'timeupdate' event on the video

    video.addEventListener('timeupdate', screenShotFn);
    function screenShotFn() {
        // Check if the current time has reached the stop time
        if (video.currentTime >= stopTime) {
            // Pause the video
            capture();
            video.removeEventListener("timeupdate", screenShotFn);
        }
    }

</script>