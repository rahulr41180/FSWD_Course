<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <div style="height: 1000px; background-color: lightgray;">
        <h1>Scroll down to see the effects</h1>

    </div>
</body>

</html>

<script>
    function handleScroll() {
        // Your scroll handling logic goes here

        // Check if the page is being refreshed
        console.log('performance.navigation.type:', performance.navigation.type)
        if (performance.navigation.type === 1) {
            console.log("Page is being refreshed. Skipping handleScroll.");
            return;
        }

        console.log("Scrolled!");

        // For the sake of example, let's simulate some heavy computation
        // This could be your actual logic like updating the UI, making API calls, etc.
        for (let i = 0; i < 1000; i++) {
            // console.log('i:', i)
            // Some time-consuming task
        }
    }

    function debounce(func, delay) {
        let timerId;

        console.log('timerId:', timerId)
        return function () {
            const context = this;
            const args = arguments;
            console.log('args:', args)
            clearTimeout(timerId);
            timerId = setTimeout(function () {
                func.apply(context, args);
            }, delay)
            
        }
    }


    const debouncedScroll = debounce(handleScroll, 500);
    // console.log('debouncedScroll:', debouncedScroll)
    window.addEventListener('scroll', debouncedScroll);

    // Remove the event listener when the page is loaded - it is not working because of browser support

    // window.addEventListener('beforeunload', function () {
    //     window.removeEventListener('scroll', debouncedScroll);
    // });

    // debouncedScroll();
</script>